<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Threat Analysis - Advanced Threat Intelligence Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            light: '#4f46e5',
                            dark: '#4338ca',
                        },
                        secondary: {
                            light: '#10b981',
                            dark: '#059669',
                        },
                        danger: {
                            light: '#ef4444',
                            dark: '#dc2626',
                        },
                        warning: {
                            light: '#f59e0b',
                            dark: '#d97706',
                        }
                    },
                }
            }
        }
    </script>
    <style>
        .threat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .pulse {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
            100% {
                opacity: 1;
            }
        }
        .map-container {
            background-image: radial-gradient(circle, #3b82f6 1px, transparent 1px);
            background-size: 20px 20px;
        }
        .glow {
            box-shadow: 0 0 10px rgba(59, 130, 246, 0.7);
        }
    </style>
</head>
<body class="bg-gray-100 font-sans">
    <!-- Navigation -->
    <nav class="bg-gray-900 text-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center">
                        <i class="fas fa-shield-alt text-blue-400 text-2xl mr-2"></i>
                        <span class="text-xl font-bold">IMS Cyber Intelligence Agency</span>
                    </div>
                    <div class="hidden md:block">
                        <div class="ml-10 flex items-baseline space-x-4">
                            <a href="#" class="px-3 py-2 rounded-md text-sm font-medium bg-gray-800 text-white">Dashboard</a>
                            <a href="#" class="px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white">Threat Feed</a>
                            <a href="#" class="px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white">APT Database</a>
                            <a href="#" class="px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white">Predictive Analysis</a>
                            <a href="#" class="px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white">Reports</a>
                        </div>
                    </div>
                </div>
                <div class="hidden md:block">
                    <div class="ml-4 flex items-center md:ml-6">
                        <button class="p-1 rounded-full text-gray-400 hover:text-white focus:outline-none">
                            <i class="fas fa-bell"></i>
                        </button>
                        <div class="ml-3 relative">
                            <div>
                                <button class="max-w-xs flex items-center text-sm rounded-full focus:outline-none">
                                    <img class="h-8 w-8 rounded-full" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" alt="">
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="-mr-2 flex md:hidden">
                    <button type="button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
        <!-- Header -->
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
            <div>
                <h1 class="text-3xl font-bold text-gray-900">Threat Intelligence Dashboard</h1>
                <p class="mt-2 text-gray-600">Real-time monitoring and predictive threat analysis</p>
            </div>
            <div class="mt-4 md:mt-0 flex space-x-3">
                <button class="px-4 py-2 bg-primary-light hover:bg-primary-dark text-white rounded-md flex items-center">
                    <i class="fas fa-sync-alt mr-2"></i> Refresh Data
                </button>
                <button class="px-4 py-2 bg-secondary-light hover:bg-secondary-dark text-white rounded-md flex items-center">
                    <i class="fas fa-plus mr-2"></i> New Scan
                </button>
            </div>
        </div>

        <!-- Alert Banner -->
        <div class="bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded-r">
            <div class="flex">
                <div class="flex-shrink-0">
                    <i class="fas fa-exclamation-triangle text-red-500"></i>
                </div>
                <div class="ml-3">
                    <p class="text-sm text-red-700">
                        <span class="font-bold">Critical Alert:</span> New APT campaign detected targeting financial sector in North America. <a href="#" class="font-medium text-red-700 underline hover:text-red-600">View details</a>
                    </p>
                </div>
            </div>
        </div>

        <!-- Stats Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
            {% block stats_cards %}
            <!-- Active Threats -->
            <div class="bg-white overflow-hidden shadow rounded-lg">
                <div class="px-4 py-5 sm:p-6">
                    <div class="flex items-center">
                        <div class="flex-shrink-0 bg-red-500 rounded-md p-3">
                            <i class="fas fa-bug text-white"></i>
                        </div>
                        <div class="ml-5 w-0 flex-1">
                            <dt class="text-sm font-medium text-gray-500 truncate">Active Threats</dt>
                            <dd class="flex items-baseline">
                                <div class="text-2xl font-semibold text-gray-900">1,248</div>
                                <div class="ml-2 flex items-baseline text-sm font-semibold text-red-600">
                                    <i class="fas fa-arrow-up text-xs"></i>
                                    <span class="sr-only">Increased by</span>
                                    12%
                                </div>
                            </dd>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Predictive Alerts -->
            <div class="bg-white overflow-hidden shadow rounded-lg">
                <div class="px-4 py-5 sm:p-6">
                    <div class="flex items-center">
                        <div class="flex-shrink-0 bg-yellow-500 rounded-md p-3">
                            <i class="fas fa-robot text-white"></i>
                        </div>
                        <div class="ml-5 w-0 flex-1">
                            <dt class="text-sm font-medium text-gray-500 truncate">Predictive Alerts</dt>
                            <dd class="flex items-baseline">
                                <div class="text-2xl font-semibold text-gray-900">87</div>
                                <div class="ml-2 flex items-baseline text-sm font-semibold text-yellow-600">
                                    <i class="fas fa-arrow-up text-xs"></i>
                                    <span class="sr-only">Increased by</span>
                                    5%
                                </div>
                            </dd>
                        </div>
                    </div>
                </div>
            </div>

            <!-- APTs Tracked -->
            <div class="bg-white overflow-hidden shadow rounded-lg">
                <div class="px-4 py-5 sm:p-6">
                    <div class="flex items-center">
                        <div class="flex-shrink-0 bg-blue-500 rounded-md p-3">
                            <i class="fas fa-database text-white"></i>
                        </div>
                        <div class="ml-5 w-0 flex-1">
                            <dt class="text-sm font-medium text-gray-500 truncate">APTs Tracked</dt>
                            <dd class="flex items-baseline">
                                <div class="text-2xl font-semibold text-gray-900">143</div>
                                <div class="ml-2 flex items-baseline text-sm font-semibold text-green-600">
                                    <i class="fas fa-arrow-up text-xs"></i>
                                    <span class="sr-only">Increased by</span>
                                    3%
                                </div>
                            </dd>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Threat Prediction Accuracy -->
            <div class="bg-white overflow-hidden shadow rounded-lg">
                <div class="px-4 py-5 sm:p-6">
                    <div class="flex items-center">
                        <div class="flex-shrink-0 bg-green-500 rounded-md p-3">
                            <i class="fas fa-brain text-white"></i>
                        </div>
                        <div class="ml-5 w-0 flex-1">
                            <dt class="text-sm font-medium text-gray-500 truncate">Prediction Accuracy</dt>
                            <dd class="flex items-baseline">
                                <div class="text-2xl font-semibold text-gray-900">92.7%</div>
                                <div class="ml-2 flex items-baseline text-sm font-semibold text-green-600">
                                    <i class="fas fa-arrow-up text-xs"></i>
                                    <span class="sr-only">Increased by</span>
                                    1.2%
                                </div>
                            </dd>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Dashboard Content -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
            {% block dashboard_content %}
            <!-- Threat Map -->
            <div class="lg:col-span-2 bg-white shadow rounded-lg overflow-hidden">
                <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
                    <h3 class="text-lg leading-6 font-medium text-gray-900">
                        <i class="fas fa-globe-americas text-blue-500 mr-2"></i> Global Threat Activity Map
                    </h3>
                </div>
                <div class="p-4">
                    <div class="map-container h-96 rounded-lg relative" style="background-image: none;">
                        <!-- SVG World Map Background -->
                        <svg viewBox="0 0 2000 1000" class="absolute inset-0 w-full h-full" preserveAspectRatio="xMidYMid meet">
                            <!-- Simplified world map paths -->
                            <path d="M1200,300 C1250,350 1300,370 1350,360 L1400,350 L1450,370 L1500,360 L1550,320 L1600,290 L1650,270 L1700,260 L1750,250 L1800,260 L1850,280 L1900,300 L1950,320 L2000,330 L2000,0 L0,0 L0,330 L50,320 L100,300 L150,280 L200,260 L250,260 L300,270 L350,290 L400,320 L450,360 L500,370 L550,350 L600,350 L650,360 L700,370 L750,360 L800,350 L850,370 L900,360 L950,320 L1000,290 L1050,270 L1100,260 L1150,250 L1200,260 L1250,280 L1300,300 L1350,320 L1400,330 L1400,1000 L2000,1000 L2000,330 Z" fill="#E5E7EB" opacity="0.3"/>
                            <path d="M150,300 L200,320 L250,330 L300,340 L350,350 L400,360 L450,370 L500,380 L550,390 L600,400 L650,410 L700,420 L750,430 L800,440 L850,450 L900,460 L950,470 L1000,480 L1050,490 L1100,500 L1150,510 L1200,520 L1250,530 L1300,540 L1350,550 L1400,560 L1450,570 L1500,580 L1550,590 L1600,600 L1650,610 L1700,620 L1750,630 L1800,640 L1850,650 L1900,660 L1950,670 L2000,680 L2000,330 L1950,320 L1900,300 L1850,280 L1800,260 L1750,250 L1700,260 L1650,270 L1600,290 L1550,320 L1500,360 L1450,370 L1400,350 L1350,360 L1300,370 L1250,360 L1200,350 L1150,370 L1100,360 L1050,320 L1000,290 L950,360 L900,370 L850,360 L800,350 L750,360 L700,370 L650,360 L600,350 L550,350 L500,370 L450,360 L400,320 L350,290 L300,270 L250,260 L200,260 L150,280 L100,300 L50,320 L0,330 L0,680 L50,670 L100,660 L150,650 L200,640 L250,630 L300,620 L350,610 L400,600 L450,590 L500,580 L550,570 L600,560 L650,550 L700,540 L750,530 L800,520 L850,510 L900,500 L950,490 L1000,480 L1050,470 L1100,460 L1150,450 L1200,440 L1250,430 L1300,420 L1350,410 L1400,400 L1450,390 L1500,380 L1550,370 L1600,360 L1650,350 L1700,340 L1750,330 L1800,320 L1850,310 L1900,300 L1950,290 L2000,280 L2000,680 Z" fill="#E5E7EB" opacity="0.2"/>
                        </svg>
                        
                        <!-- Simulated threat points on map representing major hacking bases -->
                        <div class="absolute top-[25%] left-[35%] w-4 h-4 bg-red-500 rounded-full pulse glow" data-threat="APT29" title="Russia"></div>
                        <div class="absolute top-[28%] left-[78%] w-4 h-4 bg-red-500 rounded-full pulse glow" data-threat="Lazarus Group" title="North Korea"></div>
                        <div class="absolute top-[45%] left-[72%] w-4 h-4 bg-red-500 rounded-full pulse glow" data-threat="APT41" title="China"></div>
                        <div class="absolute top-[60%] left-[20%] w-4 h-4 bg-red-500 rounded-full pulse glow" data-threat="FIN7" title="Brazil"></div>
                        <div class="absolute top-[30%] left-[15%] w-4 h-4 bg-red-500 rounded-full pulse glow" data-threat="DarkHotel" title="India"></div>
                        <div class="absolute top-[42%] left-[65%] w-4 h-4 bg-red-500 rounded-full pulse glow" data-threat="Equation Group" title="Iran"></div>
                        <div class="absolute top-1/4 left-1/4 w-4 h-4 bg-red-500 rounded-full pulse glow" data-threat="APT29"></div>
                        <div class="absolute top-1/3 left-1/2 w-4 h-4 bg-red-500 rounded-full pulse glow" data-threat="Lazarus Group"></div>
                        <div class="absolute top-2/3 left-1/3 w-4 h-4 bg-red-500 rounded-full pulse glow" data-threat="FIN7"></div>
                        <div class="absolute top-3/4 left-3/4 w-4 h-4 bg-red-500 rounded-full pulse glow" data-threat="APT41"></div>
                        <div class="absolute top-1/5 left-3/4 w-4 h-4 bg-red-500 rounded-full pulse glow" data-threat="DarkHotel"></div>
                        <div class="absolute top-1/2 left-1/5 w-4 h-4 bg-red-500 rounded-full pulse glow" data-threat="Equation Group"></div>
                    </div>
                    <div class="mt-4 grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div class="bg-gray-50 p-3 rounded">
                            <div class="text-sm text-gray-500">Most Active Region</div>
                            <div class="font-medium">Asia-Pacific</div>
                        </div>
                        <div class="bg-gray-50 p-3 rounded">
                            <div class="text-sm text-gray-500">Most Targeted Sector</div>
                            <div class="font-medium">Financial</div>
                        </div>
                        <div class="bg-gray-50 p-3 rounded">
                            <div class="text-sm text-gray-500">Top Threat Type</div>
                            <div class="font-medium">Ransomware</div>
                        </div>
                        <div class="bg-gray-50 p-3 rounded">
                            <div class="text-sm text-gray-500">Predicted Next Target</div>
                            <div class="font-medium">Healthcare</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Threats -->
            <div class="bg-white shadow rounded-lg overflow-hidden">
                <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
                    <h3 class="text-lg leading-6 font-medium text-gray-900">
                        <i class="fas fa-clock text-blue-500 mr-2"></i> Recent Threat Alerts
                    </h3>
                </div>
                <div class="divide-y divide-gray-200">
                    <!-- Threat Item 1 -->
                    <div class="p-4 hover:bg-gray-50 cursor-pointer">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 h-10 w-10 rounded-full bg-red-100 flex items-center justify-center">
                                <i class="fas fa-fire text-red-500"></i>
                            </div>
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">New Zero-Day in Microsoft Exchange</div>
                                <div class="text-sm text-gray-500">APT29 exploiting CVE-2023-XXXX</div>
                                <div class="mt-1 flex items-center text-xs text-gray-500">
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                                        Critical
                                    </span>
                                    <span class="ml-2">10 min ago</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Threat Item 2 -->
                    <div class="p-4 hover:bg-gray-50 cursor-pointer">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 h-10 w-10 rounded-full bg-yellow-100 flex items-center justify-center">
                                <i class="fas fa-exclamation-triangle text-yellow-500"></i>
                            </div>
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">Phishing Campaign Targeting Banks</div>
                                <div class="text-sm text-gray-500">Lazarus Group using new techniques</div>
                                <div class="mt-1 flex items-center text-xs text-gray-500">
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                        High
                                    </span>
                                    <span class="ml-2">25 min ago</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Threat Item 3 -->
                    <div class="p-4 hover:bg-gray-50 cursor-pointer">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center">
                                <i class="fas fa-bolt text-blue-500"></i>
                            </div>
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">Predicted Ransomware Attack</div>
                                <div class="text-sm text-gray-500">87% probability in next 72 hours</div>
                                <div class="mt-1 flex items-center text-xs text-gray-500">
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                        Predictive
                                    </span>
                                    <span class="ml-2">1 hour ago</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Threat Item 4 -->
                    <div class="p-4 hover:bg-gray-50 cursor-pointer">
                        <div class="flex items-center">
                            <div class="flex-shrink-0 h-10 w-10 rounded-full bg-green-100 flex items-center justify-center">
                                <i class="fas fa-shield-alt text-green-500"></i>
                            </div>
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">New Threat Intelligence Feed</div>
                                <div class="text-sm text-gray-500">Updated APT41 indicators</div>
                                <div class="mt-1 flex items-center text-xs text-gray-500">
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                        Info
                                    </span>
                                    <span class="ml-2">2 hours ago</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="px-4 py-4 bg-gray-50 text-right sm:px-6">
                    <button type="button" class="inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-primary-light bg-white hover:text-primary-dark focus:outline-none">
                        View all alerts
                        <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Threat Analysis Section -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
            {% block threat_analysis %}
            <!-- Threat Scanner -->
            <div class="bg-white shadow rounded-lg overflow-hidden">
                <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
                    <h3 class="text-lg leading-6 font-medium text-gray-900">
                        <i class="fas fa-search text-blue-500 mr-2"></i> Threat Scanner
                    </h3>
                </div>
                <div class="p-6">
                    <div class="mb-4">
                        <label for="scan-type" class="block text-sm font-medium text-gray-700">Scan Type</label>
                        <select id="scan-type" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-light focus:border-primary-light sm:text-sm rounded-md">
                            <option>Quick Scan</option>
                            <option>Deep Scan</option>
                            <option>Network Scan</option>
                            <option>APT Pattern Scan</option>
                            <option>Predictive Threat Scan</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label for="scan-target" class="block text-sm font-medium text-gray-700">Scan Target</label>
                        <input type="text" id="scan-target" class="mt-1 focus:ring-primary-light focus:border-primary-light block w-full shadow-sm sm:text-sm border-gray-300 rounded-md" placeholder="IP, Domain, URL, or Hash">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700">Threat Intelligence Sources</label>
                        <div class="mt-2 space-y-2">
                            <div class="flex items-start">
                                <div class="flex items-center h-5">
                                    <input id="source-mitre" name="source-mitre" type="checkbox" checked class="focus:ring-primary-light h-4 w-4 text-primary-light border-gray-300 rounded">
                                </div>
                                <div class="ml-3 text-sm">
                                    <label for="source-mitre" class="font-medium text-gray-700">MITRE ATT&CK</label>
                                    <p class="text-gray-500">Advanced threat patterns</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div class="flex items-center h-5">
                                    <input id="source-vt" name="source-vt" type="checkbox" checked class="focus:ring-primary-light h-4 w-4 text-primary-light border-gray-300 rounded">
                                </div>
                                <div class="ml-3 text-sm">
                                    <label for="source-vt" class="font-medium text-gray-700">VirusTotal</label>
                                    <p class="text-gray-500">Malware intelligence</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div class="flex items-center h-5">
                                    <input id="source-alienvault" name="source-alienvault" type="checkbox" class="focus:ring-primary-light h-4 w-4 text-primary-light border-gray-300 rounded">
                                </div>
                                <div class="ml-3 text-sm">
                                    <label for="source-alienvault" class="font-medium text-gray-700">AlienVault OTX</label>
                                    <p class="text-gray-500">Open threat exchange</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-light hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-light">
                        <i class="fas fa-search mr-2"></i> Start Scan
                    </button>
                </div>
            </div>

            <!-- Threat Prediction -->
            <div class="bg-white shadow rounded-lg overflow-hidden">
                <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
                    <h3 class="text-lg leading-6 font-medium text-gray-900">
                        <i class="fas fa-brain text-blue-500 mr-2"></i> Threat Prediction
                    </h3>
                </div>
                <div class="p-6">
                    <div class="mb-4">
                        <div class="flex justify-between mb-1">
                            <span class="text-sm font-medium text-gray-700">Ransomware Attack</span>
                            <span class="text-sm font-medium text-gray-700">87%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2.5">
                            <div class="bg-red-500 h-2.5 rounded-full" style="width: 87%"></div>
                        </div>
                        <p class="mt-1 text-xs text-gray-500">High probability in financial sector (next 72h)</p>
                    </div>
                    <div class="mb-4">
                        <div class="flex justify-between mb-1">
                            <span class="text-sm font-medium text-gray-700">Supply Chain Attack</span>
                            <span class="text-sm font-medium text-gray-700">65%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2.5">
                            <div class="bg-yellow-500 h-2.5 rounded-full" style="width: 65%"></div>
                        </div>
                        <p class="mt-1 text-xs text-gray-500">Medium probability in tech sector (next 7d)</p>
                    </div>
                    <div class="mb-4">
                        <div class="flex justify-between mb-1">
                            <span class="text-sm font-medium text-gray-700">Zero-Day Exploit</span>
                            <span class="text-sm font-medium text-gray-700">42%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2.5">
                            <div class="bg-blue-500 h-2.5 rounded-full" style="width: 42%"></div>
                        </div>
                        <p class="mt-1 text-xs text-gray-500">Targeting cloud providers (next 14d)</p>
                    </div>
                    <div class="mt-6">
                        <h4 class="text-sm font-medium text-gray-700 mb-2">Prediction Factors</h4>
                        <ul class="list-disc pl-5 space-y-1 text-sm text-gray-600">
                            <li>Recent APT activity patterns</li>
                            <li>Vulnerability exploit trends</li>
                            <li>Dark web chatter analysis</li>
                            <li>Historical attack cycles</li>
                            <li>Geopolitical events</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- APT Intelligence -->
            <div class="bg-white shadow rounded-lg overflow-hidden">
                <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
                    <h3 class="text-lg leading-6 font-medium text-gray-900">
                        <i class="fas fa-database text-blue-500 mr-2"></i> APT Intelligence
                    </h3>
                </div>
                <div class="p-6">
                    <div class="mb-4">
                        <label for="apt-search" class="block text-sm font-medium text-gray-700">Search APT Groups</label>
                        <div class="mt-1 relative rounded-md shadow-sm">
                            <input type="text" id="apt-search" class="focus:ring-primary-light focus:border-primary-light block w-full pr-10 sm:text-sm border-gray-300 rounded-md" placeholder="APT29, Lazarus, etc.">
                            <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
                                <i class="fas fa-search text-gray-400"></i>
                            </div>
                        </div>
                    </div>
                    <div class="space-y-4">
                        <div class="p-3 border border-gray-200 rounded-md hover:border-blue-300 cursor-pointer">
                            <div class="flex justify-between">
                                <span class="font-medium">APT29 (Cozy Bear)</span>
                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                                    Active
                                </span>
                            </div>
                            <div class="mt-1 text-sm text-gray-600">Russian state-sponsored group targeting governments and think tanks</div>
                        </div>
                        <div class="p-3 border border-gray-200 rounded-md hover:border-blue-300 cursor-pointer">
                            <div class="flex justify-between">
                                <span class="font-medium">Lazarus Group</span>
                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                                    Active
                                </span>
                            </div>
                            <div class="mt-1 text-sm text-gray-600">North Korean group focused on financial gain and cyber espionage</div>
                        </div>
                        <div class="p-3 border border-gray-200 rounded-md hover:border-blue-300 cursor-pointer">
                            <div class="flex justify-between">
                                <span class="font-medium">APT41</span>
                                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                    Moderate
                                </span>
                            </div>
                            <div class="mt-1 text-sm text-gray-600">Chinese group conducting cyber espionage and financial crime</div>
                        </div>
                    </div>
                    <div class="mt-4 text-right">
                        <a href="#" class="text-sm font-medium text-primary-light hover:text-primary-dark">View all APT groups â†’</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Threat Feed -->
        <div class="bg-white shadow rounded-lg overflow-hidden mb-6">
            {% block threat_feed %}
            <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
                <div class="flex items-center justify-between">
                    <h3 class="text-lg leading-6 font-medium text-gray-900">
                        <i class="fas fa-rss text-blue-500 mr-2"></i> Threat Intelligence Feed
                    </h3>
                    <!-- Add your code here to show the list of threats -->
                    <ul>
                      {% for threat in threats %}
                        <li>{{ threat }}</li>
                      {% endfor %}
                    </ul>
                    <div class="flex space-x-3">
                        <button class="px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50">
                            <i class="fas fa-filter mr-1"></i> Filter
                        </button>
                        <button class="px-3 py-1 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50">
                            <i class="fas fa-download mr-1"></i> Export
                        </button>
                    </div>
                </div>
            </div>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Threat</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Source</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">First Seen</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Severity</th>
                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        <tr class="hover:bg-gray-50">
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0 h-10 w-10 rounded-full bg-red-100 flex items-center justify-center">
                                        <i class="fas fa-fire text-red-500"></i>
                                    </div>
                                    <div class="ml-4">
                                        <div class="text-sm font-medium text-gray-900">Exchange Zero-Day</div>
                                        <div class="text-sm text-gray-500">CVE-2023-XXXX</div>
                                    </div>
                                </div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900">Exploit</div>
                                <div class="text-sm text-gray-500">APT29</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="text-sm text-gray-900">Microsoft</span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="text-sm text-gray-900">Today</span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                                    Critical
                                </span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                <span class="text-red-600 font-medium">Active</span>
                            </td>
                        </tr>
                        <tr class="hover:bg-gray-50">
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0 h-10 w-10 rounded-full bg-yellow-100 flex items-center justify-center">
                                        <i class="fas fa-file-invoice-dollar text-yellow-500"></i>
                                    </div>
                                    <div class="ml-4">
                                        <div class="text-sm font-medium text-gray-900">Invoice Phishing</div>
                                        <div class="text-sm text-gray-500">New variant</div>
                                    </div>
                                </div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900">Phishing</div>
                                <div class="text-sm text-gray-500">FIN7</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="text-sm text-gray-900">CISA</span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="text-sm text-gray-900">2 days ago</span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                                    High
                                </span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                <span class="text-yellow-600 font-medium">Active</span>
                            </td>
                        </tr>
                        <tr class="hover:bg-gray-50">
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0 h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center">
                                        <i class="fas fa-bolt text-blue-500"></i>
                                    </div>
                                    <div class="ml-4">
                                        <div class="text-sm font-medium text-gray-900">Cloud Jacking</div>
                                        <div class="text-sm text-gray-500">Predicted attack</div>
                                    </div>
                                </div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900">Prediction</div>
                                <div class="text-sm text-gray-500">APT41</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="text-sm text-gray-900">AI Model</span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="text-sm text-gray-900">Today</span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
                                    Predictive
                                </span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                <span class="text-blue-600 font-medium">Monitoring</span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="px-4 py-4 bg-gray-50 text-right sm:px-6">
                <nav class="inline-flex -space-x-px rounded-md shadow-sm" aria-label="Pagination">
                    <a href="#" class="relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50">
                        <span class="sr-only">Previous</span>
                        <i class="fas fa-chevron-left"></i>
                    </a>
                    <a href="#" aria-current="page" class="relative z-10 inline-flex items-center px-4 py-2 border border-primary-light bg-primary-50 text-sm font-medium text-primary-light">
                        1
                    </a>
                    <a href="#" class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50">
                        2
                    </a>
                    <a href="#" class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50">
                        3
                    </a>
                    <a href="#" class="relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50">
                        <span class="sr-only">Next</span>
                        <i class="fas fa-chevron-right"></i>
                    </a>
                </nav>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800">
        <div class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-sm font-semibold text-gray-400 tracking-wider uppercase">Product</h3>
                    <ul class="mt-4 space-y-4">
                        <li><a href="#" class="text-base text-gray-300 hover:text-white">Features</a></li>
                        <li><a href="#" class="text-base text-gray-300 hover:text-white">Integrations</a></li>
                        <li><a href="#" class="text-base text-gray-300 hover:text-white">Pricing</a></li>
                        <li><a href="#" class="text-base text-gray-300 hover:text-white">API</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-sm font-semibold text-gray-400 tracking-wider uppercase">Resources</h3>
                    <ul class="mt-4 space-y-4">
                        <li><a href="#" class="text-base text-gray-300 hover:text-white">Documentation</a></li>
                        <li><a href="#" class="text-base text-gray-300 hover:text-white">Threat Reports</a></li>
                        <li><a href="#" class="text-base text-gray-300 hover:text-white">Blog</a></li>
                        <li><a href="#" class="text-base text-gray-300 hover:text-white">Webinars</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-sm font-semibold text-gray-400 tracking-wider uppercase">Company</h3>
                    <ul class="mt-4 space-y-4">
                        <li><a href="#" class="text-base text-gray-300 hover:text-white">About</a></li>
                        <li><a href="#" class="text-base text-gray-300 hover:text-white">Careers</a></li>
                        <li><a href="#" class="text-base text-gray-300 hover:text-white">Partners</a></li>
                        <li><a href="#" class="text-base text-gray-300 hover:text-white">Contact</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-sm font-semibold text-gray-400 tracking-wider uppercase">Legal</h3>
                    <ul class="mt-4 space-y-4">
                        <li><a href="#" class="text-base text-gray-300 hover:text-white">Privacy</a></li>
                        <li><a href="#" class="text-base text-gray-300 hover:text-white">Terms</a></li>
                        <li><a href="#" class="text-base text-gray-300 hover:text-white">Compliance</a></li>
                        <li><a href="#" class="text-base text-gray-300 hover:text-white">Security</a></li>
                    </ul>
                </div>
            </div>
            <div class="mt-8 border-t border-gray-700 pt-8 md:flex md:items-center md:justify-between">
                <div class="flex space-x-6 md:order-2">
                    <a href="#" class="text-gray-400 hover:text-gray-300">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-gray-300">
                        <i class="fab fa-github"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-gray-300">
                        <i class="fab fa-linkedin"></i>
                    </a>
                </div>
                <p class="mt-8 text-base text-gray-400 md:mt-0 md:order-1">
                    &copy; 2025 IMS Cyber Intelligence Agency. All rights reserved.
                </p>
            </div>
        </div>
    </footer>

    <!-- Threat Details Modal (hidden by default) -->
    <div id="threat-modal" class="fixed z-10 inset-0 overflow-y-auto hidden" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true"></div>
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
            <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full">
                <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div class="sm:flex sm:items-start">
                        <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10">
                            <i class="fas fa-exclamation-triangle text-red-600"></i>
                        </div>
                        <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
                            <h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title">
                                Threat Details: <span id="threat-name">APT29 - Cozy Bear</span>
                            </h3>
                            <div class="mt-2">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <h4 class="font-medium text-gray-900">Description</h4>
                                        <p class="text-sm text-gray-500" id="threat-description">
                                            APT29 is a Russian state-sponsored threat group that has been active since at least 2008. 
                                            This group has targeted government organizations, diplomatic entities, think tanks, 
                                            and other organizations of interest to the Russian government.
                                        </p>
                                    </div>
                                    <div>
                                        <h4 class="font-medium text-gray-900">Recent Activity</h4>
                                        <ul class="text-sm text-gray-500 list-disc pl-5 space-y-1" id="threat-activity">
                                            <li>Exploiting Microsoft Exchange vulnerabilities (2023)</li>
                                            <li>SolarWinds supply chain attack (2020)</li>
                                            <li>Targeting COVID-19 research organizations (2020)</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <h4 class="font-medium text-gray-900">Indicators of Compromise</h4>
                                        <div class="text-sm text-gray-500 space-y-1" id="threat-iocs">
                                            <div class="bg-gray-50 p-2 rounded font-mono text-xs">IP: 185.86.149.94</div>
                                            <div class="bg-gray-50 p-2 rounded font-mono text-xs">Domain: secure-updates[.]com</div>
                                            <div class="bg-gray-50 p-2 rounded font-mono text-xs">Hash: a3f4d7e2f1b6c8d9e0f1a2b3c4d5e6f7</div>
                                        </div>
                                    </div>
                                    <div>
                                        <h4 class="font-medium text-gray-900">Predicted Next Moves</h4>
                                        <div class="text-sm text-gray-500 space-y-2" id="threat-predictions">
                                            <div>
                                                <div class="flex justify-between mb-1">
                                                    <span>Cloud Infrastructure</span>
                                                    <span>78%</span>
                                                </div>
                                                <div class="w-full bg-gray-200 rounded-full h-1.5">
                                                    <div class="bg-yellow-500 h-1.5 rounded-full" style="width: 78%"></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div class="flex justify-between mb-1">
                                                    <span>Government Targets</span>
                                                    <span>65%</span>
                                                </div>
                                                <div class="w-full bg-gray-200 rounded-full h-1.5">
                                                    <div class="bg-blue-500 h-1.5 rounded-full" style="width: 65%"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                    <button type="button" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary-light text-base font-medium text-white hover:bg-primary-dark focus:outline-none sm:ml-3 sm:w-auto sm:text-sm">
                        <i class="fas fa-shield-alt mr-2"></i> Mitigation Strategies
                    </button>
                    <button type="button" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm" onclick="document.getElementById('threat-modal').classList.add('hidden')">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Simulate real-time threat updates
        function updateThreatCounters() {
            const threatsElement = document.querySelector('[data-threats]');
            const predictionsElement = document.querySelector('[data-predictions]');
            
            // Random fluctuation for demo purposes
            const currentThreats = parseInt(threatsElement.textContent.replace(',', ''));
            const currentPredictions = parseInt(predictionsElement.textContent);
            
            const newThreats = currentThreats + Math.floor(Math.random() * 10) - 3;
            const newPredictions = currentPredictions + Math.floor(Math.random() * 3) - 1;
            
            threatsElement.textContent = Math.max(1000, newThreats).toLocaleString();
            predictionsElement.textContent = Math.max(80, Math.min(95, newPredictions));
            
            setTimeout(updateThreatCounters, 5000);
        }
        
        // Initialize threat map interactions
        function initThreatMap() {
            const threatPoints = document.querySelectorAll('.map-container > div');
            threatPoints.forEach(point => {
                point.addEventListener('click', function() {
                    const threatName = this.getAttribute('data-threat');
                    document.getElementById('threat-name').textContent = threatName;
                    
                    // In a real app, we'd fetch this data from an API
                    let description = '';
                    let activity = [];
                    let iocs = [];
                    
                    switch(threatName) {
                        case 'APT29':
                            description = 'APT29 is a Russian state-sponsored threat group that has been active since at least 2008. This group has targeted government organizations, diplomatic entities, think tanks, and other organizations of interest to the Russian government.';
                            activity = [
                                'Exploiting Microsoft Exchange vulnerabilities (2023)',
                                'SolarWinds supply chain attack (2020)',
                                'Targeting COVID-19 research organizations (2020)'
                            ];
                            iocs = [
                                'IP: 185.86.149.94',
                                'Domain: secure-updates[.]com',
                                'Hash: a3f4d7e2f1b6c8d9e0f1a2b3c4d5e6f7'
                            ];
                            break;
                        case 'Lazarus Group':
                            description = 'Lazarus Group is a North Korean state-sponsored cybercrime group responsible for some of the most destructive cyber attacks in history, including the WannaCry ransomware attacks and the Sony Pictures hack.';
                            activity = [
                                'Targeting cryptocurrency exchanges (2023)',
                                'Supply chain attacks via 3CX software (2023)',
                                'WannaCry ransomware attacks (2017)'
                            ];
                            iocs = [
                                'IP: 172.245.18.37',
                                'Domain: update-center[.]net',
                                'Hash: b5a4d8e7c2f1a6b9d0e3f4a5b6c7d8e9'
                            ];
                            break;
                        default:
                            description = 'Advanced Persistent Threat group with sophisticated capabilities. This group has been active in multiple campaigns targeting various sectors globally.';
                            activity = [
                                'Recent zero-day exploit campaigns',
                                'Phishing campaigns targeting executives',
                                'Supply chain compromises'
                            ];
                            iocs = [
                                'IP: 192.168.1.1',
                                'Domain: example-malicious[.]com',
                                'Hash: c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9'
                            ];
                    }
                    
                    document.getElementById('threat-description').textContent = description;
                    
                    const activityList = document.getElementById('threat-activity');
                    activityList.innerHTML = '';
                    activity.forEach(item => {
                        const li = document.createElement('li');
                        li.textContent = item;
                        activityList.appendChild(li);
                    });
                    
                    const iocsContainer = document.getElementById('threat-iocs');
                    iocsContainer.innerHTML = '';
                    iocs.forEach(ioc => {
                        const div = document.createElement('div');
                        div.className = 'bg-gray-50 p-2 rounded font-mono text-xs';
                        div.textContent = ioc;
                        iocsContainer.appendChild(div);
                    });
                    
                    document.getElementById('threat-modal').classList.remove('hidden');
                });
            });
        }
        
        // Initialize scanner functionality
        function initScanner() {
            const scanButton = document.querySelector('#threat-scanner button');
            scanButton.addEventListener('click', function() {
                const scanType = document.getElementById('scan-type').value;
                const scanTarget = document.getElementById('scan-target').value;
                
                if (!scanTarget) {
                    alert('Please enter a scan target');
                    return;
                }
                
                // Show loading state
                scanButton.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Scanning...';
                scanButton.disabled = true;
                
                // Simulate scan
                setTimeout(function() {
                    // Show results
                    alert(`Scan completed!\n\nType: ${scanType}\nTarget: ${scanTarget}\n\nResults: 3 threats detected`);
                    
                    // Reset button
                    scanButton.innerHTML = '<i class="fas fa-search mr-2"></i> Start Scan';
                    scanButton.disabled = false;
                }, 3000);
            });
        }
        
        // Initialize the dashboard when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            updateThreatCounters();
            initThreatMap();
            initScanner();
            
            // Close modal when clicking outside
            document.getElementById('threat-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.add('hidden');
                }
            });
        });
    </script>
</body>
</html>